# Deny access to relay logs, config, env, etc.
<FilesMatch "^(relay-log\.txt|\.env|\.ini|\.git|composer\.(json|lock))$">
    Order allow,deny
    Deny from all
</FilesMatch>

# Disable directory listing
Options -Indexes

# Prevent access to backup/config/archive files
<FilesMatch "\.(bak|config|sql|fla|psd|log|sh)$">
    Order allow,deny
    Deny from all
</FilesMatch>

# Basic anti-bot User-Agent filtering (optional)
BrowserMatchNoCase "curl" bad_bot
BrowserMatchNoCase "wget" bad_bot
BrowserMatchNoCase "python" bad_bot
Order allow,deny
Allow from all
Deny from env=bad_bot

# Optional: Basic request rate limit (5 seconds between hits per IP)
RewriteEngine On
RewriteCond %{REQUEST_URI} ^/relay\.php$
RewriteCond %{ENV:REDIRECT_STATUS} !200
RewriteCond %{HTTP:Authorization} !^$
RewriteCond %{ENV:BLOCK_%{REMOTE_ADDR}} ^1$
RewriteRule ^ - [F,L]

RewriteCond %{REQUEST_URI} ^/relay\.php$
RewriteRule ^ - [E=BLOCK_%{REMOTE_ADDR}:1,S=5]

# Optional: Force HTTPS only
RewriteCond %{HTTPS} off
RewriteRule ^ https://%{HTTP_HOST}%{REQUEST_URI} [L,R=301]
